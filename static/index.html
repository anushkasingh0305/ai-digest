<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Digest Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-box">
            <h1>AI Digest</h1>
            <p>Secure Dashboard</p>
            <form id="login-form">
                <div class="form-group">
                    <input type="text" id="username" placeholder="Username" required autofocus>
                </div>
                <div class="form-group">
                    <input type="password" id="password" placeholder="Password" required>
                </div>
                <button type="submit" class="btn btn-primary btn-large">Login</button>
                <div id="login-error" class="login-error"></div>
            </form>
            <p class="login-hint">Demo: admin / admin</p>
        </div>
    </div>

    <!-- Dashboard (hidden until login) -->
    <div id="dashboard-page" class="dashboard" style="display: none;">
        <div class="container">
            <!-- Header -->
            <header class="header">
                <div class="header-content">
                    <h1>üöÄ AI Digest</h1>
                    <p class="subtitle">Smart Content Aggregation & Delivery</p>
                </div>
                <div class="header-status">
                    <span id="status-indicator" class="status-dot unknown"></span>
                    <span id="status-text">Checking...</span>
                    <button id="btn-logout" class="btn btn-secondary" style="margin-left: 20px;">Logout</button>
                </div>
            </header>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab-button active" data-tab="overview">üìä Overview</button>
            <button class="tab-button" data-tab="pipeline">‚öôÔ∏è Pipeline</button>
            <button class="tab-button" data-tab="schedule">üïê Schedule</button>
            <button class="tab-button" data-tab="delivery">üìß Delivery</button>
            <button class="tab-button" data-tab="webhooks">üîî Webhooks</button>
            <button class="tab-button" data-tab="adapters">üîå Adapters</button>
            <button class="tab-button" data-tab="logging">üìù Logging</button>
            <button class="tab-button" data-tab="digests">üìö Digests</button>
        </nav>

        <!-- Tab Content -->
        <main class="content">
            <!-- Overview Tab -->
            <section id="overview-tab" class="tab-content active">
                <h2>System Overview</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3>System Status</h3>
                        <div id="overview-status" class="info-block">
                            <p>Loading...</p>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Quick Actions</h3>
                        <div class="button-group">
                            <button id="btn-run-pipeline" class="btn btn-primary">‚ñ∂ Run Pipeline</button>
                            <button id="btn-refresh" class="btn btn-secondary">üîÑ Refresh</button>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3>Recent Activity</h3>
                    <div id="activity-log" class="log-container">
                        <p class="empty">No activity yet</p>
                    </div>
                </div>
            </section>

            <!-- Pipeline Tab -->
            <section id="pipeline-tab" class="tab-content">
                <h2>Pipeline Control</h2>
                <div class="card">
                    <h3>Execute Digest Generation</h3>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="pipeline-deliver"> Deliver after generation
                        </label>
                    </div>
                    <button id="btn-run-pipeline-exec" class="btn btn-primary btn-large">
                        ‚ñ∂ Execute Pipeline Now
                    </button>
                    <div id="pipeline-status" class="status-message"></div>
                </div>
                <div class="card">
                    <h3>Pipeline Information</h3>
                    <div id="pipeline-info" class="info-block">
                        <p>Loading...</p>
                    </div>
                </div>
            </section>

            <!-- Schedule Tab -->
            <section id="schedule-tab" class="tab-content">
                <h2>Scheduler Configuration</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3>Schedule Settings</h3>
                        <div class="form-group">
                            <label for="schedule-hour">Hour (UTC, 0-23):</label>
                            <input type="number" id="schedule-hour" min="0" max="23" value="6">
                        </div>
                        <div class="form-group">
                            <label for="schedule-minute">Minute (0-59):</label>
                            <input type="number" id="schedule-minute" min="0" max="59" value="0">
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="schedule-deliver"> Deliver automatically
                            </label>
                        </div>
                        <button id="btn-update-schedule" class="btn btn-primary">Save Schedule</button>
                        <div id="schedule-message" class="status-message"></div>
                    </div>
                    <div class="card">
                        <h3>Scheduler Status</h3>
                        <div id="scheduler-status" class="info-block">
                            <p>Loading...</p>
                        </div>
                        <div class="button-group" style="margin-top: 20px;">
                            <button id="btn-start-scheduler" class="btn btn-success">‚ñ∂ Start</button>
                            <button id="btn-stop-scheduler" class="btn btn-danger">‚èπ Stop</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Delivery Tab -->
            <section id="delivery-tab" class="tab-content">
                <h2>Delivery Configuration</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3>Email Delivery</h3>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="delivery-email-enabled"> Enable Email
                            </label>
                        </div>
                        <div class="form-group">
                            <label for="delivery-email-address">Email Address:</label>
                            <input type="email" id="delivery-email-address" placeholder="user@example.com">
                        </div>
                        <button id="btn-update-delivery" class="btn btn-primary">Save Settings</button>
                        <div id="delivery-message" class="status-message"></div>
                    </div>
                    <div class="card">
                        <h3>Telegram Delivery</h3>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="delivery-telegram-enabled"> Enable Telegram
                            </label>
                        </div>
                        <div class="form-group">
                            <label for="delivery-telegram-chat-id">Chat ID:</label>
                            <input type="text" id="delivery-telegram-chat-id" placeholder="123456789">
                        </div>
                        <p class="hint">Get your Chat ID from @userinfobot on Telegram</p>
                    </div>
                </div>
            </section>

            <!-- Webhooks Tab -->
            <section id="webhooks-tab" class="tab-content">
                <h2>Webhooks</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3>Configured Webhooks</h3>
                        <div id="webhooks-list" class="webhooks-list">
                            <p class="empty">No webhooks configured</p>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Create Webhook</h3>
                        <p id="webhook-mode" class="hint">Create new webhook</p>
                        <div class="form-group">
                            <label for="webhook-id">ID</label>
                            <input type="text" id="webhook-id" placeholder="unique-id">
                        </div>
                        <div class="form-group">
                            <label for="webhook-name">Name</label>
                            <input type="text" id="webhook-name" placeholder="My Slack webhook">
                        </div>
                        <div class="form-group">
                            <label for="webhook-type">Type</label>
                            <select id="webhook-type">
                                <option value="slack">Slack</option>
                                <option value="discord">Discord</option>
                                <option value="generic">Generic</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="webhook-url">URL</label>
                            <input type="text" id="webhook-url" placeholder="https://...">
                        </div>
                        <div class="form-group">
                            <label for="webhook-headers">Headers (JSON)</label>
                            <input type="text" id="webhook-headers" placeholder='{"Authorization":"Bearer ..."}'>
                        </div>
                        <div class="form-group">
                            <label for="webhook-payload">Payload Template (JSON)</label>
                            <input type="text" id="webhook-payload" placeholder='{"text":"{{content}}"}'>
                        </div>
                        <div class="button-group">
                            <button id="btn-create-webhook" class="btn btn-primary">Create Webhook</button>
                            <button id="btn-save-webhook" class="btn btn-success hidden">Save Changes</button>
                            <button id="btn-cancel-webhook" class="btn btn-secondary hidden">Cancel</button>
                        </div>
                        <div id="webhook-message" class="status-message"></div>
                    </div>
                </div>
            </section>

            <!-- Adapters Tab -->
            <section id="adapters-tab" class="tab-content">
                <h2>Content Adapters</h2>
                <div id="adapters-list" class="adapters-container">
                    <p class="empty">Loading adapters...</p>
                </div>
            </section>

            <!-- Logging Tab -->
            <section id="logging-tab" class="tab-content">
                <h2>Logging Configuration</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3>Log Settings</h3>
                        <div class="form-group">
                            <label for="logging-level">Log Level:</label>
                            <select id="logging-level">
                                <option value="DEBUG">DEBUG</option>
                                <option value="INFO" selected>INFO</option>
                                <option value="WARNING">WARNING</option>
                                <option value="ERROR">ERROR</option>
                                <option value="CRITICAL">CRITICAL</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="logging-file-enabled"> Write to file
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="logging-console-enabled"> Console output
                            </label>
                        </div>
                        <button id="btn-update-logging" class="btn btn-primary">Save Settings</button>
                        <div id="logging-message" class="status-message"></div>
                    </div>
                    <div class="card">
                        <h3>Log File Information</h3>
                        <div id="logging-info" class="info-block">
                            <p>Loading...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Digests Tab -->
            <section id="digests-tab" class="tab-content">
                <h2>Digest History</h2>
                <div class="card">
                    <div class="controls">
                        <input type="number" id="digests-limit" min="1" max="100" value="10" placeholder="Limit">
                        <input type="number" id="digests-offset" min="0" value="0" placeholder="Offset">
                        <button id="btn-load-digests" class="btn btn-secondary">Load Digests</button>
                    </div>
                    <div id="digests-list" class="digests-container">
                        <p class="empty">No digests yet</p>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>AI Digest v0.1.0 | <a href="/api">API Docs</a> | <a href="/metrics">Prometheus Metrics</a></p>
        </footer>
    </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
